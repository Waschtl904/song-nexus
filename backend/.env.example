# ============================================================================
# üéµ SONG-NEXUS BACKEND - ENVIRONMENT VARIABLES TEMPLATE
# ============================================================================
# Copy this file to .env and fill in your values
# DO NOT commit actual .env file to git (add to .gitignore)
# Database: PostgreSQL with 10 tables (verified from pgAdmin 4)
# ============================================================================

# ============================================================================
# üì¶ DATABASE CONFIGURATION
# ============================================================================
# PostgreSQL connection with 10 tables:
# users | tracks | orders | purchases | play_history | play_stats |
# webauthn_credentials | magic_links | magic_link_tokens | design_system
DATABASE_URL=postgres://postgres:password@localhost:5432/song_nexus_dev
DB_HOST=localhost
DB_PORT=5432
DB_NAME=song_nexus_dev
DB_USER=postgres
DB_PASSWORD=your_secure_password_here
DB_SSL=false
DB_POOL_MIN=2
DB_POOL_MAX=20
DB_IDLE_TIMEOUT_MS=30000

# ============================================================================
# üîê AUTHENTICATION & SECURITY
# ============================================================================
# JWT Configuration
JWT_SECRET=your-super-secret-jwt-key-min-32-characters-required
JWT_EXPIRE=7d
JWT_ALGORITHM=HS256

# Session Management
SESSION_SECRET=your-session-secret-key-min-32-chars
SESSION_MAX_AGE=604800000
COOKIE_SECRET=your-cookie-secret-min-32-chars

# CSRF Protection
CSRF_TOKEN_LENGTH=32

# Password Hashing
BCRYPT_ROUNDS=10

# ============================================================================
# üì± SERVER CONFIGURATION
# ============================================================================
NODE_ENV=development
PORT=3000
HOST=localhost
TRUST_PROXY=false
BODY_PARSER_LIMIT=100mb

# ============================================================================
# üîí HTTPS & SSL/TLS (for development: use mkcert)
# ============================================================================
USE_HTTPS=true
CERT_PATH=./backend/certs/localhost.pem
KEY_PATH=./backend/certs/localhost-key.pem
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true

# ============================================================================
# üåê CORS & FRONTEND CONFIGURATION
# ============================================================================
FRONTEND_URL=https://localhost:5500
ALLOWED_ORIGINS=https://localhost:5500,http://localhost:5500
API_BASE=https://localhost:3000/api
CORS_CREDENTIALS=true

# ============================================================================
# üí≥ PAYPAL INTEGRATION
# ============================================================================
PAYPAL_MODE=sandbox
PAYPAL_CLIENT_ID=your-sandbox-client-id-here
PAYPAL_CLIENT_SECRET=your-sandbox-secret-here
PAYPAL_WEBHOOK_ID=your-webhook-id-here
PAYPAL_CURRENCY=EUR
PAYPAL_RETURN_URL=https://localhost:5500/success
PAYPAL_CANCEL_URL=https://localhost:5500/cancel

# ============================================================================
# üîê WEBAUTHN BIOMETRIC AUTHENTICATION (Table: webauthn_credentials)
# ============================================================================
WEBAUTHN_ENABLED=true
WEBAUTHN_RP_ID=localhost
WEBAUTHN_RP_NAME=SONG-NEXUS
WEBAUTHN_ORIGIN=https://localhost:5500
WEBAUTHN_TIMEOUT=60000
WEBAUTHN_ALGORITHMS=ES256,RS256

# ============================================================================
# üìß MAGIC LINK AUTHENTICATION (Tables: magic_links, magic_link_tokens)
# ============================================================================
MAGIC_LINK_ENABLED=true
MAGIC_LINK_EXPIRY_MINUTES=15
MAGIC_LINK_TOKEN_LENGTH=32
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_FROM=noreply@song-nexus.local

# ============================================================================
# ‚öôÔ∏è FEATURE FLAGS
# ============================================================================
ENABLE_WEBAUTHN=true
ENABLE_MAGIC_LINKS=true
ENABLE_EMAIL_AUTH=true
ENABLE_PAYPAL=true
ENABLE_ANALYTICS=true
ENABLE_RATE_LIMITING=true
SOFT_DELETE_ENABLED=true

# ============================================================================
# üìÅ FILE UPLOAD (Table: tracks)
# ============================================================================
UPLOAD_DIR=./backend/public/audio
MAX_FILE_SIZE=104857600
ALLOWED_AUDIO_FORMATS=mp3,wav,m4a,flac
ALLOWED_IMAGE_FORMATS=jpg,jpeg,png,webp

# ============================================================================
# üîÑ RATE LIMITING
# ============================================================================
RATE_LIMIT_AUTH_WINDOW_MS=900000
RATE_LIMIT_AUTH_MAX=5
RATE_LIMIT_API_WINDOW_MS=60000
RATE_LIMIT_API_MAX=30
RATE_LIMIT_STREAM_MAX=50

# ============================================================================
# üìù LOGGING & MONITORING
# ============================================================================
LOG_LEVEL=info
LOG_FILE=logs/app.log
LOG_FORMAT=combined
DEBUG=false
ENABLE_PERFORMANCE_MONITOR=true
PERFORMANCE_LOG_FILE=logs/performance.log

# ============================================================================
# üß™ DEVELOPMENT ONLY (DO NOT use in production)
# ============================================================================
DEV_LOGIN_ENABLED=false
DEV_CORS_PERMISSIVE=false
DEV_USER_EMAIL=dev@example.com

# ============================================================================
# üìä ANALYTICS & TRACKING (Tables: play_history, play_stats)
# ============================================================================
ENABLE_PLAY_HISTORY=true
ENABLE_USER_STATISTICS=true
ENABLE_LEADERBOARDS=true

# ============================================================================
# üé® DESIGN SYSTEM CONFIGURATION (Table: design_system)
# ============================================================================
# 70+ design tokens stored in database
DEFAULT_DESIGN_THEME=light
DEFAULT_PRIMARY_COLOR=#00CC77
DEFAULT_SECONDARY_COLOR=#5E5240
DEFAULT_BACKGROUND_COLOR=#FCF8F9
DEFAULT_TEXT_COLOR=#133452

# ============================================================================
# üìã NOTES FOR PRODUCTION DEPLOYMENT
# ============================================================================
# 1. Change all SECRET values (use: openssl rand -base64 32)
# 2. Use strong database password
# 3. Set NODE_ENV=production
# 4. Update WebAuthn RP settings to match your domain
# 5. Configure PayPal live credentials
# 6. Use SSL certificates from Let's Encrypt (not mkcert)
# 7. Set TRUST_PROXY=true if behind reverse proxy
# 8. Database: PostgreSQL with these 10 tables:
#    - users: user accounts & credentials
#    - tracks: music metadata & files
#    - orders: PayPal transactions
#    - purchases: user track purchases
#    - play_history: track play events
#    - play_stats: advanced player statistics
#    - webauthn_credentials: biometric auth data
#    - magic_links: email-based login tokens
#    - magic_link_tokens: legacy magic link storage
#    - design_system: theme & design tokens (70+ fields)